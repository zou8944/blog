<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zou8944.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.8.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="Beat Jelly; Hit Jelly; Kill Jelly.">
<meta property="og:type" content="website">
<meta property="og:title" content="果冻 | Jelly">
<meta property="og:url" content="https://zou8944.com/page/6/index.html">
<meta property="og:site_name" content="果冻 | Jelly">
<meta property="og:description" content="Beat Jelly; Hit Jelly; Kill Jelly.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="果冻 | Jelly">
<meta property="article:tag" content="果冻 博客">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://zou8944.com/page/6/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/6/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>果冻 | Jelly</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">果冻 | Jelly</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">果冻的碎碎念</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">果冻 | Jelly</p>
  <div class="site-description" itemprop="description">Beat Jelly; Hit Jelly; Kill Jelly.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">78</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zou8944.com/Spring%20Webflow%20-%20%E9%85%8D%E7%BD%AE-springwebflow-%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="果冻 | Jelly">
      <meta itemprop="description" content="Beat Jelly; Hit Jelly; Kill Jelly.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="果冻 | Jelly">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Spring%20Webflow%20-%20%E9%85%8D%E7%BD%AE-springwebflow-%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">Spring Webflow - 配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-05 22:33:00" itemprop="dateCreated datePublished" datetime="2018-09-05T22:33:00+08:00">2018-09-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-02-16 23:27:46" itemprop="dateModified" datetime="2021-02-16T23:27:46+08:00">2021-02-16</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Webflow/" itemprop="url" rel="index"><span itemprop="name">Spring | Webflow</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<ol>
<li>本文基于Spring Web Flow 2.4.5，其它版本配置方式可能略有不同，请参考相应版本的<a target="_blank" rel="noopener" href="https://projects.spring.io/spring-webflow/">官方文档</a></li>
<li>Maven依赖<br>maven库查询推荐地址：<a target="_blank" rel="noopener" href="http://mvnrepository.com/">http://mvnrepository.com/</a></li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.webflow&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-webflow&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.4.5.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h1 id="Web-Flow嵌入到Spring-MVC工作流简介"><a href="#Web-Flow嵌入到Spring-MVC工作流简介" class="headerlink" title="Web Flow嵌入到Spring MVC工作流简介"></a>Web Flow嵌入到Spring MVC工作流简介</h1><p>请求被DispatcherServlet拦截 -&gt; 分发flow进行处理，返回view -&gt; viewResolver解析 -&gt; 返回请求</p>
<hr>
<h1 id="配置项预览"><a href="#配置项预览" class="headerlink" title="配置项预览"></a>配置项预览</h1><ul>
    <li>FlowRegistry：必须，注册流程，指明流程配置文件所在位置；指定流程id(用于请求访问标识)；指定流程属性；此外还可以传入FlowBuilderServices进行更多个性化配置</li>
    <li>FlowBuilderServices：必须，用于设定流程配置文件中EL表达式的解析器、form属性绑定时的转换器、view-state的view解析器等，很重要</li>
    <li>FlowExecutor：必须，用于执行流程，可指定执行监听器(可选，常用于流程安全和持久化)</li>
    <li>FlowHandlerAdapter：必须，用于适配Spring MVC，配置时传入FlowExecutor</li>
    <li>FlowHandlerMapping：必须，用于将请求映射到对应的flow，配置时传入FlowRegistry</li>
</ul>

<hr>
<h1 id="配置I-注册流程-FlowRegistry"><a href="#配置I-注册流程-FlowRegistry" class="headerlink" title="配置I - 注册流程 - FlowRegistry"></a>配置I - 注册流程 - FlowRegistry</h1><p>FlowRegistry用于注册流程实例，指定流程位置和流程id，并可自定义流程创建相关内容</p>
<h2 id="注册flow的各种方式"><a href="#注册flow的各种方式" class="headerlink" title="注册flow的各种方式"></a>注册flow的各种方式</h2><ul>
<li>直接指定流程位置<br>默认情况下，web-flow的id为其文件名减去后缀名，如下配置的id为booking。指定了基地址或使用了通配符时除外。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-location path=&quot;/WEB-INF/flows/booking/booking.xml&quot; /&gt;</span><br><span class="line">// 注册了一个路径为/WEB-INF/flows/booking/booking.xml的流程，其余为默认配置。</span><br></pre></td></tr></table></figure></li>
<li>自定义id</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-location path=&quot;/WEB-INF/flows/booking/booking.xml&quot; id=&quot;bookHotel&quot; /&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><p> 定义流程属性<br>如下定义了一个带有属性caption，其值为”Books a hotel”的流程。属性的使用方法暂时不了解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-location path=&quot;/WEB-INF/flows/booking/booking.xml&quot;&gt;</span><br><span class="line">    &lt;webflow:flow-definition-attributes&gt;</span><br><span class="line">        &lt;webflow:attribute name=&quot;caption&quot; value=&quot;Books a hotel&quot; /&gt;</span><br><span class="line">    &lt;/webflow:flow-definition-attributes&gt;</span><br><span class="line">&lt;/webflow:flow-location&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>使用通配定义流程位置</p>
</li>
</ul>
<p><strong>使用该方法并没有正确实验出id</strong>，这点作为参考</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-location-pattern value=&quot;/WEB-INF/flows/**/*-flow.xml&quot; /&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用基地址<br>使用基地址的flow的id为其path属性减去文件名，如下配置的id为/hotels/booking；如果path中没有路径信息，只有文件名，则id为文件名减去后缀。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-registry id=&quot;flowRegistry&quot; base-path=&quot;/WEB-INF&quot;&gt;</span><br><span class="line">    &lt;webflow:flow-location path=&quot;/hotels/booking/booking.xml&quot; /&gt;</span><br><span class="line">&lt;/webflow:flow-registry&gt;</span><br></pre></td></tr></table></figure>
<h2 id="flow-id属性总结"><a href="#flow-id属性总结" class="headerlink" title="flow id属性总结"></a>flow id属性总结</h2></li>
</ul>
<ol>
<li> id的作用<br>id用于请求定位到某个确切的flow，如当请求路径为<a target="_blank" rel="noopener" href="http://localhost:8090/Floyd/search-flow%EF%BC%8C%E5%85%B6%E4%B8%ADFloyd%E6%98%AF%E9%A1%B9%E7%9B%AE%E5%90%8D%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%9C%89id%E4%B8%BAsearch-flow%E7%9A%84flow%E5%AD%98%E5%9C%A8%EF%BC%8C%E5%88%99%E4%BC%9A%E8%AE%BF%E9%97%AE%E8%AF%A5flow">http://localhost:8090/Floyd/search-flow，其中Floyd是项目名，如果有id为search-flow的flow存在，则会访问该flow</a></li>
<li>id的定义</li>
</ol>
<ul>
<li>没有基地址或通配符时，flow的id为文件名减去后缀，如<code>&lt;webflow:flow-location path=&quot;/WEB-INF/flows/booking/booking.xml&quot; /&gt;</code>这里的id为booking</li>
<li>有基地址时，id为path的值减去文件名，如基地址为<code>/WEB-INF</code>， path=<code>/flows/booking/booking.xml</code>时，id被确定为<code>flows/booking</code></li>
<li>有通配符时，该情况比较特殊，按照<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-webflow/docs/2.4.5.RELEASE/reference/html/system-setup.html#flow-registry-base-path">官方说明</a>并没有验证通过，这里略过。<br>当显式指定了id属性时，则使用指定的id。<b>推荐自定义id</b><h2 id="FlowRegistry继承"><a href="#FlowRegistry继承" class="headerlink" title="FlowRegistry继承"></a>FlowRegistry继承</h2>FlowRegistry是可以继承的，可以定义一个公用的注册器，在多个子注册器中继承该注册器</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- my-system-config.xml --&gt;</span><br><span class="line">&lt;webflow:flow-registry id=&quot;flowRegistry&quot; parent=&quot;sharedFlowRegistry&quot;&gt;</span><br><span class="line">    &lt;webflow:flow-location path=&quot;/WEB-INF/flows/booking/booking.xml&quot; /&gt;</span><br><span class="line">&lt;/webflow:flow-registry&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- shared-config.xml --&gt;</span><br><span class="line">&lt;webflow:flow-registry id=&quot;sharedFlowRegistry&quot;&gt;</span><br><span class="line">    &lt;!-- Global flows shared by several applications --&gt;</span><br><span class="line">&lt;/webflow:flow-registry&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="配置II-使用FlowBuilder-services"><a href="#配置II-使用FlowBuilder-services" class="headerlink" title="配置II - 使用FlowBuilder services"></a>配置II - 使用FlowBuilder services</h1><p>使用FlowBuilder Services可以在build流程时自定义服务，比如视图解析器、EL表达式解析器、类型格式化和转换服务等。如无显式设定FlowBuilder Services，系统将使用默认实现。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-registry id=&quot;flowRegistry&quot; flow-builder-services=&quot;flowBuilderServices&quot;&gt;</span><br><span class="line">    &lt;webflow:flow-location path=&quot;/WEB-INF/flows/booking/booking.xml&quot; /&gt;</span><br><span class="line">&lt;/webflow:flow-registry&gt;</span><br><span class="line"></span><br><span class="line">&lt;webflow:flow-builder-services id=&quot;flowBuilderServices&quot;</span><br><span class="line">    conversion-service=&quot;conversionService&quot;</span><br><span class="line">    expression-parser=&quot;expressionParser&quot;</span><br><span class="line">    view-factory-creator=&quot;viewFactoryCreator&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;conversionService&quot; class=&quot;...&quot; /&gt;</span><br><span class="line">&lt;bean id=&quot;expressionParser&quot; class=&quot;...&quot; /&gt;</span><br><span class="line">&lt;bean id=&quot;viewFactoryCreator&quot; class=&quot;...&quot; /&gt;</span><br></pre></td></tr></table></figure>
<h2 id="自定义视图解析器-view-factory-creator"><a href="#自定义视图解析器-view-factory-creator" class="headerlink" title="自定义视图解析器 view-factory-creator"></a>自定义视图解析器 view-factory-creator</h2><p>view-factory-creator用于视图解析工作，默认的creator可以支持Spring MVC支持的几种视图类型：JSP, Velocity，FreeMarker等。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-registry id=&quot;flowRegistry&quot; flow-builder-services=&quot;flowBuilderServices&quot;&gt;</span><br><span class="line">	&lt;webflow:location path=&quot;/WEB-INF/hotels/booking/booking.xml&quot; /&gt;</span><br><span class="line">&lt;/webflow:flow-registry&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 尤其注意这里的development，设置为true时表示开启开发模式，该模式下会在flow定义改变时自动re-load，甚至flow中引用的resource bundle发生了变化都会热重载 --&gt;</span><br><span class="line">&lt;webflow:flow-builder-services id=&quot;flowBuilderServices&quot; view-factory-creator=&quot;mvcViewFactoryCreator&quot; development=&quot;true&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;mvcViewFactoryCreator&quot; class=&quot;org.springframework.webflow.mvc.builder.MvcViewFactoryCreator&quot;&gt;</span><br><span class="line">	&lt;!-- myExistingViewResolverToUseForFlows就是我们常用的视图解析器，注意这里引用的是一个列表 --&gt;</span><br><span class="line">	&lt;property name=&quot;viewResolvers&quot; ref=&quot;myExistingViewResolverToUseForFlows&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">... ... </span><br><span class="line">... ...</span><br><span class="line">&lt;!-- 做验证时使用的是javaconfig的形式，这种形式并没有验证过 --&gt;</span><br><span class="line">&lt;property name=&quot;myExistingViewResolverToUseForFlows&quot;&gt;</span><br><span class="line">    &lt;list&gt;</span><br><span class="line">        &lt;ref bean=&quot;viewResolver&quot; /&gt;</span><br><span class="line">    &lt;/list&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;viewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;</span><br><span class="line">   &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/&quot;/&gt;</span><br><span class="line">   &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="自定义表达式解析器-expression-parser"><a href="#自定义表达式解析器-expression-parser" class="headerlink" title="自定义表达式解析器 expression-parser"></a>自定义表达式解析器 expression-parser</h2><p>expression-parser用于定义表达式解析器，默认的解析器使用逻辑：当类路径下有Unified EL解析器时，则使用；没有时，则使用OGNL表达式解析器(官方文档在<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-webflow/docs/2.4.5.RELEASE/reference/html/el.html#el-unified-el">EL表达式</a>一章和<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-webflow/docs/2.4.5.RELEASE/reference/html/system-setup.html#builder-service-expression-parser">系统设置</a>一章关于默认表达式解析说法有出入，自己认为比较可信的是Spring Web Flow 2.1以后，默认使用Spring EL表达式解析器)。<br>下面是手动配置成Unified EL解析器的方式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-builder-services expression-parser=&quot;expressionParser&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;expressionParser&quot; class=&quot;org.springframework.webflow.expression.el.WebFlowELExpressionParser&quot;&gt;</span><br><span class="line">    &lt;constructor-arg&gt;</span><br><span class="line">        &lt;bean class=&quot;org.jboss.el.ExpressionFactoryImpl&quot; /&gt;</span><br><span class="line">    &lt;/constructor-arg&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h2 id="自定义类型转换器-conversion-service"><a href="#自定义类型转换器-conversion-service" class="headerlink" title="自定义类型转换器 conversion-service"></a>自定义类型转换器 conversion-service</h2><p> 详细内容参见本系列视图渲染相关章节或<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-webflow/docs/2.4.5.RELEASE/reference/html/views.html#converter-configuration">官方文档</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-registry id=&quot;flowRegistry&quot; flow-builder-services=&quot;flowBuilderServices&quot; ... /&gt;</span><br><span class="line"></span><br><span class="line">&lt;webflow:flow-builder-services id=&quot;flowBuilderServices&quot; conversion-service=&quot;defaultConversionService&quot; ... /&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;defaultConversionService&quot; class=&quot;org.springframework.binding.convert.service.DefaultConversionService&quot;&gt;</span><br><span class="line">	&lt;constructor-arg ref=&quot;applicationConversionSevice&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;applicationConversionService&quot; class=&quot;somepackage.ApplicationConversionServiceFactoryBean&quot;&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class ApplicationConversionServiceFactoryBean extends FormattingConversionServiceFactoryBean &#123;</span><br><span class="line">    @Override</span><br><span class="line">    protected void installFormatters(FormatterRegistry registry) &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="配置III-发布流程执行器-FlowExecutor"><a href="#配置III-发布流程执行器-FlowExecutor" class="headerlink" title="配置III - 发布流程执行器 - FlowExecutor"></a>配置III - 发布流程执行器 - FlowExecutor</h1><p>FlowExecutor用于执行flow并管理flow执行过程，常见的自定义项有：设置监听器，监听流程执行过程并作出相应，如security监听器，用于监听并控制流程的访问权限；调整flow的部分持久化选项等。</p>
<ul>
<li>注册监听器</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 这里是为特定的flow应用该监听器，当不设criteria属性时，将对所有flow应用 --&gt;</span><br><span class="line">&lt;webflow:flow-execution-listeners&gt;</span><br><span class="line">    &lt;webflow:listener ref=&quot;securityListener&quot; criteria=&quot;securedFlow1,securedFlow2&quot;/&gt;</span><br><span class="line">&lt;/webflow:flow-execution-listeners&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>调整持久化参数</li>
<li>max-executions： 设定为每个用户保留的执行数(没错，就是执行数)，当超过该数量时，最先的那个执行会被清除。(这里的执行，我认为是一个新开的且处于激活状态下的flow实例)</li>
<li>max-execution-snapshots： 设定每个执行保留的最大快照数。不允许保留时，设为0。允许无线保留时，设为-1。(快照用于浏览器的返回按钮)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:flow-executor id=&quot;flowExecutor&quot; flow-registry=&quot;flowRegistry&quot;&gt;</span><br><span class="line">    &lt;webflow:flow-execution-repository max-executions=&quot;5&quot; max-execution-snapshots=&quot;30&quot; /&gt;</span><br><span class="line">&lt;/webflow:flow-executor&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h1 id="配置IV-Spring-MVC集成"><a href="#配置IV-Spring-MVC集成" class="headerlink" title="配置IV - Spring MVC集成"></a>配置IV - Spring MVC集成</h1><h2 id="基础配置（将请求转发给flow）"><a href="#基础配置（将请求转发给flow）" class="headerlink" title="基础配置（将请求转发给flow）"></a>基础配置（将请求转发给flow）</h2><ul>
<li>Spring MVC基础配置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">	&lt;servlet-name&gt;Spring MVC Dispatcher Servlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;</span><br><span class="line">	&lt;init-param&gt;</span><br><span class="line">		&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</span><br><span class="line">		&lt;param-value&gt;/WEB-INF/web-application-config.xml&lt;/param-value&gt;</span><br><span class="line">	&lt;/init-param&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">	&lt;servlet-name&gt;Spring MVC Dispatcher Servlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;!-- 不能使用类型/*的通配符进行匹配，否则会出现jsp不解析直接回发给浏览器的情况 --&gt;</span><br><span class="line">	&lt;url-pattern&gt;/&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="FlowHandlerAdapter"><a href="#FlowHandlerAdapter" class="headerlink" title="FlowHandlerAdapter"></a>FlowHandlerAdapter</h2><p>该步骤是使得Web Flow能够适配Spring MVC<br>当一个对flow的请求被接收到时，FlowHandlerAdapter会决定是启动一个全新的flow还是继续之前的流程(如从一个view-state跳转到下一个state就属于继续之前的流程)，继续之前的flow是需要在请求有相关信息才行。有关这一方面，web flow默认有如下设定：<br>&emsp;&emsp;1.Http请求参数在任何情况下都是可以使用的<br>&emsp;&emsp;2.当一个flow执行结束，且结束时没有想浏览器发送最后的响应时，默认的handler会尝试在同一个request中启动一个新的flow执行<br>&emsp;&emsp;3.除了NoSuchFlowExecutionException异常外，所有其它异常都会以冒泡的方式抛到Dispatcher中。这是因为默认的handler会尝试自动从该异常中恢复过来，恢复的方式是新开一个全新的flow执行<br>针对大多数设定，都可以通过实现FlowHandlerAdapter类的子类进行自定义。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Enables FlowHandler URL mapping --&gt;</span><br><span class="line">&lt;bean class=&quot;org.springframework.webflow.mvc.servlet.FlowHandlerAdapter&quot;&gt;</span><br><span class="line">	&lt;!-- flowExecutor就是前文声明的执行器 --&gt;</span><br><span class="line">	&lt;property name=&quot;flowExecutor&quot; ref=&quot;flowExecutor&quot; /&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="配置V-FlowHandlerMapping"><a href="#配置V-FlowHandlerMapping" class="headerlink" title="配置V - FlowHandlerMapping"></a>配置V - FlowHandlerMapping</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Maps request paths to flows in the flowRegistry;</span><br><span class="line">	e.g. a path of /hotels/booking looks for a flow with id &quot;hotels/booking&quot; --&gt;</span><br><span class="line">&lt;bean class=&quot;org.springframework.webflow.mvc.servlet.FlowHandlerMapping&quot;&gt;</span><br><span class="line">	&lt;!-- flowRegistry就是前文声明的注册器 --&gt;</span><br><span class="line">	&lt;property name=&quot;flowRegistry&quot; ref=&quot;flowRegistry&quot;/&gt;</span><br><span class="line">	&lt;property name=&quot;order&quot; value=&quot;0&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>有了Flow的基本配置和这里的两个Spring MVC的集成配置，请求就能够映射到flow中了。接下来就是写Flow了。想要快速上手的可忽略本文后面的内容，转而直接看本系列其它文章。</p>
<hr>
<h1 id="配置VI-实现自定义的FlowHandler"><a href="#配置VI-实现自定义的FlowHandler" class="headerlink" title="配置VI - 实现自定义的FlowHandler"></a>配置VI - 实现自定义的FlowHandler</h1><ul>
<li>FlowHandler讲解<br>FlowHandler可用于自定义flow在HTTP Servlert环境中执行的方式，FlowHandler在FlowHandlerAdapter中被使用，主要负责如下内容：</li>
</ul>
<p> &emsp;&emsp;- 返回flow的id以用于执行该flow<br> &emsp;&emsp;- 在新流程开始时创建输入<br> &emsp;&emsp;- 在流程结束时处理流程的输出<br> &emsp;&emsp;- 在流程发生异常时，处理这些异常</p>
<p> 其主要方法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public interface FlowHandler &#123;</span><br><span class="line"></span><br><span class="line">	public String getFlowId();</span><br><span class="line"></span><br><span class="line">	public MutableAttributeMap createExecutionInputMap(HttpServletRequest request);</span><br><span class="line"></span><br><span class="line">	public String handleExecutionOutcome(FlowExecutionOutcome outcome,</span><br><span class="line">		HttpServletRequest request, HttpServletResponse response);</span><br><span class="line"></span><br><span class="line">	public String handleException(FlowException e,</span><br><span class="line">		HttpServletRequest request, HttpServletResponse response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> &emsp;&emsp;该接口的直接实现为AbstractFlowHandler，当我们想要自定义某个设定时，继承该抽象类并重写其中的方法即可。</p>
<ul>
<li>发布一个FlowHandler<br>一个FlowHandler负责一个flow，发布方式是在Spring环境中声明一个bean，该bean的name必须和我们想要处理的flow的id一致，配置好后，当方位该flow的id，则会定位到新发布的FlowHandler中，我们自定义的方法也就生效了。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 这里的BookingHandler只是一个例子，实际用时替换成我们自己的Handler --&gt;</span><br><span class="line">&lt;bean name=&quot;hotels/booking&quot; class=&quot;org.springframework.webflow.samples.booking.BookingFlowHandler&quot; /&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>着重讲一下FlowHandler中handleExecutionOutcome(…)方法<br>该方法用于处理flow结束时产生的FlowExecutionOutcome(系统自动产生)，我们常用它来在流程结束后进行重定向，比如</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class BookingFlowHandler extends AbstractFlowHandler &#123;</span><br><span class="line">	// handlExecutionOutcome()方法返回的String代表的是重定向的地址</span><br><span class="line">	public String handleExecutionOutcome(FlowExecutionOutcome outcome,</span><br><span class="line">										HttpServletRequest request, HttpServletResponse response) &#123;</span><br><span class="line">		if (outcome.getId().equals(&quot;bookingConfirmed&quot;)) &#123;</span><br><span class="line">			return &quot;/booking/show&quot;;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			return &quot;/hotels/index&quot;;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">// 当flow id为bookinConfirmed时，重定向到/booking/show，否则重定向到/hotels/index</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;默认情况下，该方法返回的地址是相关于当前Servlet的。但是我们也可以显式地指定一些前缀来扩展重定向的范围</p>
<p> &emsp;&emsp; – <code>servletRelative</code>: - 相对于当前Servlet重定向<br>&emsp;&emsp; – <code>contextRelative</code>: - 相对于当前应用重定向<br>&emsp;&emsp; – <code>serverRelative</code>: - 相对于当前服务器的基地址重定向<br>&emsp;&emsp; – <code>http:// or https://</code> - 重定向到一个完整的URI地址</p>
<p>&emsp;&emsp;相同的前缀同样适用于声明state时的view属性配上<code>externalRedirect</code>的情况</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;end-state view=&quot;externalRedirect:http://springframework.org&quot;/&gt;</span><br><span class="line">&lt;!-- 在流程结束时，跳转到spring首页 --&gt;</span><br></pre></td></tr></table></figure>

<p>—————————————————–手动分割线——————————————————————————————</p>
<h1 id="一个能用的配置-采用Java-config的方式配置"><a href="#一个能用的配置-采用Java-config的方式配置" class="headerlink" title="一个能用的配置(采用Java config的方式配置)"></a>一个能用的配置(采用Java config的方式配置)</h1><h2 id="WebInitializer（与web-xml作用类似）"><a href="#WebInitializer（与web-xml作用类似）" class="headerlink" title="WebInitializer（与web.xml作用类似）"></a>WebInitializer（与web.xml作用类似）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class WebInitializer extends AbstractAnnotationConfigDispatcherServletInitializer &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected Class&lt;?&gt;[] getRootConfigClasses() &#123;</span><br><span class="line">		return null;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected Class&lt;?&gt;[] getServletConfigClasses() &#123;</span><br><span class="line">		return new Class&lt;?&gt;[] &#123;MainConfig.class, RegisterConfig.class&#125;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected String[] getServletMappings() &#123;</span><br><span class="line">		return new String[] &#123;&quot;/&quot;&#125;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="MainConfig（Spring的主要配置文件）"><a href="#MainConfig（Spring的主要配置文件）" class="headerlink" title="MainConfig（Spring的主要配置文件）"></a>MainConfig（Spring的主要配置文件）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">@EnableWebMvc</span><br><span class="line">@ComponentScan(&quot;cn.floyd.pw&quot;)</span><br><span class="line">public class MainConfig extends WebMvcConfigurerAdapter&#123;</span><br><span class="line"></span><br><span class="line">	@Bean(name=&quot;viewResolver&quot;)</span><br><span class="line">	public ViewResolver getViewResolver() &#123;</span><br><span class="line">		InternalResourceViewResolver resolver = new InternalResourceViewResolver();</span><br><span class="line">		resolver.setPrefix(&quot;/WEB-INF/jsp/&quot;);</span><br><span class="line">		resolver.setSuffix(&quot;.jsp&quot;);</span><br><span class="line">		return resolver;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Bean</span><br><span class="line">	public MultipartResolver multipartResolver() throws IOException &#123;</span><br><span class="line">	    CommonsMultipartResolver resolver = new CommonsMultipartResolver();</span><br><span class="line">	    return resolver;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// enable the static resource</span><br><span class="line">	@Override</span><br><span class="line">	public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) &#123;</span><br><span class="line">		configurer.enable();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Bean</span><br><span class="line">    public FlowHandlerAdapter flowHandlerAdapter(@Autowired FlowExecutor flowExecutor) &#123;</span><br><span class="line">	    System.out.println(&quot;init flowHandlerAdapter&quot;);</span><br><span class="line">        FlowHandlerAdapter adapter = new FlowHandlerAdapter();</span><br><span class="line">        adapter.setFlowExecutor(flowExecutor);</span><br><span class="line">        </span><br><span class="line">        return adapter;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Bean</span><br><span class="line">    public FlowHandlerMapping flowHandlerMapping(@Autowired FlowDefinitionRegistry flowRegistry) &#123;</span><br><span class="line">        System.out.println(&quot;init flowHandlerMapping&quot;);</span><br><span class="line">        FlowHandlerMapping mapping = new FlowHandlerMapping();</span><br><span class="line">        mapping.setOrder(0);</span><br><span class="line">        mapping.setFlowRegistry(flowRegistry);</span><br><span class="line">        </span><br><span class="line">        return mapping;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="RegisterConfig（配置FlowRegister和flowExecutor）"><a href="#RegisterConfig（配置FlowRegister和flowExecutor）" class="headerlink" title="RegisterConfig（配置FlowRegister和flowExecutor）"></a>RegisterConfig（配置FlowRegister和flowExecutor）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class RegisterConfig extends AbstractFlowConfiguration &#123;</span><br><span class="line"></span><br><span class="line">    // 用于注册flow</span><br><span class="line">    @Bean(&quot;flowRegistry&quot;)</span><br><span class="line">    public FlowDefinitionRegistry flowRegistry(@Autowired FlowBuilderServices flowBuilderServices) &#123;</span><br><span class="line">        </span><br><span class="line">        return getFlowDefinitionRegistryBuilder()</span><br><span class="line">                .setBasePath(&quot;/WEB-INF/jsp/flow&quot;)</span><br><span class="line">                .addFlowLocation(&quot;/config/search-flow.xml&quot;)</span><br><span class="line">                .setFlowBuilderServices(flowBuilderServices)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Bean</span><br><span class="line">    public FlowBuilderServices flowBuilderServices(@Autowired MvcViewFactoryCreator mvcViewFactoryCreator) &#123;</span><br><span class="line">        return getFlowBuilderServicesBuilder()</span><br><span class="line">                .setViewFactoryCreator(mvcViewFactoryCreator)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Bean</span><br><span class="line">    public MvcViewFactoryCreator mvcViewFactoryCreator(@Autowired ViewResolver viewResolver) &#123;</span><br><span class="line">        MvcViewFactoryCreator creator = new MvcViewFactoryCreator();</span><br><span class="line">        List&lt;ViewResolver&gt; list = new ArrayList&lt;ViewResolver&gt;();</span><br><span class="line">        list.add(viewResolver);</span><br><span class="line">        creator.setViewResolvers(list);</span><br><span class="line">        </span><br><span class="line">        return creator;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Bean</span><br><span class="line">    public FlowExecutor flowExecutor(@Autowired FlowDefinitionRegistry flowRegistry) &#123;</span><br><span class="line">        return getFlowExecutorBuilder(flowRegistry).build();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="配置时踩过的坑"><a href="#配置时踩过的坑" class="headerlink" title="配置时踩过的坑"></a>配置时踩过的坑</h1><h2 id="flow-id的坑"><a href="#flow-id的坑" class="headerlink" title="flow id的坑"></a>flow id的坑</h2><blockquote>
<p>最开始对flow id的认识不够，导致不知道到底该如何定位到flow，其实访问方式就是  …/appName/flowId</p>
<h4 id="Web-MVC-Environment-null-not-supported"><a href="#Web-MVC-Environment-null-not-supported" class="headerlink" title="Web MVC Environment null not supported"></a>Web MVC Environment null not supported</h4><p>启动时正常，访问flow时报异常java.lang.IllegalStateException: Web MVC Environment null not supported<br> 是在创建viewFactory时出错，由于我没有采用在config中声明bean的方式创建MvcViewFactoryCreator，因此出现找不到mvc环境的问题，原来是spring在自动检测并创建bean时，会同时设置该bean的环境，因此不能自己随意采用new的方式创建这些配置类</p>
<h4 id="JSP文件不解析"><a href="#JSP文件不解析" class="headerlink" title="JSP文件不解析"></a>JSP文件不解析</h4><p>出现JSP文件不经过解析就直接传送给了浏览器的问题(对如下阐述的原理并不是很清楚)<br>url-pattern为”/*”时，能够匹配到任何路径，因此当controller返回.jsp文件时，也会被拦截，从而返回jsp源码(这里不是很理解，主要是跟自己认识的spring mvc处理流程有差别)。<br>url-pattern为”/“时，只能够匹配不带后缀的路径，因此jsp就不会被dispatcherServlet拦截，而是会被jspServlet拦截并处理。但是”/“在配置使能的情况下也能够拦截并允许静态资源的访问</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zou8944.com/Spring%20Webflow%20-%20%E5%89%8D%E8%A8%80-springwebflow-%E5%89%8D%E8%A8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="果冻 | Jelly">
      <meta itemprop="description" content="Beat Jelly; Hit Jelly; Kill Jelly.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="果冻 | Jelly">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Spring%20Webflow%20-%20%E5%89%8D%E8%A8%80-springwebflow-%E5%89%8D%E8%A8%80/" class="post-title-link" itemprop="url">Spring Webflow - 前言</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-04 20:00:00" itemprop="dateCreated datePublished" datetime="2018-09-04T20:00:00+08:00">2018-09-04</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-02-16 23:27:50" itemprop="dateModified" datetime="2021-02-16T23:27:50+08:00">2021-02-16</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Webflow/" itemprop="url" rel="index"><span itemprop="name">Spring | Webflow</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>虽然之前没有听说过Spring Web Flow这个东西，听说之后上网查了一下又有很多人不屑于使用web flow，但自己目前工作上的项目要用到它，因此学习是很有必要的。当学习一项新技术时，最快捷的方式就是上网搜索速成教程，看了一些，总觉得有些不得要领，于是转向官方文档。又怕自己久了会忘，故此写一套学习笔记，详细地介绍使用方法。该笔记参考官方文档，自己加以整理而成。</p>
<p>什么是web flow，这里也不免俗地引用一下百度百科的内容（也基本上是官方介绍的翻译。。。）：</p>
<blockquote>
<p>Spring Web Flow (SWF) 是Spring Framework的一个脱离模块。这个模块是Spring Web应用开发模块栈的一部分，Spring Web包含Spring MVC。Spring Web Flow 的目标是成为管理Web应用页面流程的最佳方案。当你的应用需要复杂的导航控制，例如向导，在一个比较大的事务过程中去指导用户经过一连串的步骤的时候，SWF将会是一个功能强大的控制器。</p>
</blockquote>
<p>详细内容见本系列正文内容</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zou8944.com/Git%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-git%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="果冻 | Jelly">
      <meta itemprop="description" content="Beat Jelly; Hit Jelly; Kill Jelly.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="果冻 | Jelly">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Git%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-git%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="post-title-link" itemprop="url">Git基础知识</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-02-15 22:31:33" itemprop="dateCreated datePublished" datetime="2018-02-15T22:31:33+08:00">2018-02-15</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-02-16 23:27:57" itemprop="dateModified" datetime="2021-02-16T23:27:57+08:00">2021-02-16</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" itemprop="url" rel="index"><span itemprop="name">版本控制</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="GIT简介"><a href="#GIT简介" class="headerlink" title="GIT简介"></a>GIT简介</h2><ol>
<li>版本控制系统：即记录同一个文档在不同人和不同时间修改的各版本的系统，对于恢复文档、差异对比、协同工作有非常大的帮助。</li>
<li>GIT是由linux创始人linus花费两周时间写成的，用于托管linux系统。目前已经有众多开源项目，如jQuery、PHP、Ruby等。
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/Git%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-git%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">果冻 | Jelly</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
